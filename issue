variables:
  MAVEN_CLI_OPTS: "-B -DskipTests -DupdateReleaseInfo=true -s settings.xml"
  MAVEN_OPTS: ''
  GIT_MAIN: main
  GIT_UAT: uat
  GIT_SNAPSHOT_REGEX: "(feat(ure)?/.*)|develop"
  GITLAB_TAG: deploy_dev
  GITLAB_ENV: none
workflow:
  rules:
  - if: "$CI_COMMIT_BRANCH =~ $GIT_SNAPSHOT_REGEX"
    variables:
      GITLAB_TAG: deploy_dev
      GITLAB_ENV: develop
  - if: "$CI_COMMIT_BRANCH == $GIT_UAT"
    variables:
      GITLAB_TAG: deploy_uat
      GITLAB_ENV: uat
  - if: "$CI_COMMIT_BRANCH == $GIT_MAIN"
    variables:
      GITLAB_TAG: deploy_prd
      GITLAB_ENV: prd
default:
  image: maven:3.9.10-amazoncorretto-21-alpine
stages:
- liquibase
- build
- publish
updateLiquibase:
  stage: liquibase
  environment: "$GITLAB_ENV"
  script:
  - "echo \"\U0001F50D Vérification de la connexion DB external_bank_data...\""
  - echo $JDBC_DB_URL
  - echo $DB_USERNAME
  - mariadb -h 192.168.89.1 -u $DB_USERNAME -p$DB_PASSWORD --connect-timeout=4 -e
    '\q' external_bank_data
  when: manual
  tags:
  - "$GITLAB_TAG"
before_script:
- echo "$JAVA_HOME"
- java -version
- mvn -version
- echo "$OLKY_CA_BUNDLE_BASE64" | base64 -d > olky.pem
- echo "Import du certificat dans le truststore..."
- keytool -import -trustcacerts -alias olky_bundle -file olky.pem -storepass $JAVA_KEYSTORE_PASSWORD
  -noprompt -keystore $JAVA_HOME/lib/security/cacerts
- keytool -list -keystore $JAVA_HOME/lib/security/cacerts -storepass $JAVA_KEYSTORE_PASSWORD
  | grep olky
build:
  stage: build
  script:
  - mvn $MAVEN_CLI_OPTS clean install -X
  artifacts:
    paths:
    - target/bank-info.jar
publish:
  stage: publish
  script:
  - mvn $MAVEN_CLI_OPTS deploy
deploy:
  needs:
  - job: build
  stage: publish
  before_script: []
  environment: "$GITLAB_ENV"
  script:
  - sudo /opt/script/gitlab/deploy_java_jar.sh -j ./target/bank-info.jar -d /opt/bank-info/
    -u bank-info -s bank-info
  tags:
  - "$GITLAB_TAG"
include:
- template: Security/Secret-Detection.gitlab-ci.yml


Security/Secret-Detection.gitlab-ci.yml ou est ce que je pourrai retrouvé ce document
