Got it â€” you want to:
	1.	Understand what the Liquibase job in your pipeline does, and
	2.	Change your project so that the liquibase folder is OUTSIDE src, so that:
	â€¢	The .csv files are NOT embedded inside the Spring Boot JAR
	â€¢	Liquibase can still run locally and on the dev server

Iâ€™ll explain both clearly and give you the exact changes to make.

â¸»

âœ… 1. What Your Liquibase Pipeline Job Currently Does

This part of your pipeline:

updateLiquibase:
  stage: liquibase
  before_script: []
  environment: $GITLAB_ENV
  variables:
    JAVA_HOME: "/usr/lib/jvm/jdk-21.0.8-oracle-x64/"
    LIQUIBASE_COMMAND_CHANGELOG_FILE: "db.changelog-master.yml"
    LIQUIBASE_SEARCH_PATH: "./src/main/resources/liquibase"
  script:
    - liquibase update
  when: manual
  tags:
    - "$GITLAB_TAG"

ğŸ” Meaning:

Line	Meaning
when: manual	You must click the button manually in GitLab to run Liquibase
LIQUIBASE_SEARCH_PATH	Liquibase looks for files in: src/main/resources/liquibase
LIQUIBASE_COMMAND_CHANGELOG_FILE	Main changelog file
liquibase update	Applies DB migrations

âœ… Right now, your CSV files are inside:

src/main/resources/liquibase

So Spring Boot packages them inside the JAR, which is what your team wants to avoid.

â¸»

âœ… 2. What Your Team Is Asking You To Do

â€œle dossier liquibase doit etre sorti de src afin de pas retrouver les fichiers .csv dans le jarâ€

This means:

âœ… Liquibase files must be outside src/
âœ… CSV files must be external files, NOT inside the JAR
âœ… The JAR stays clean
âœ… Liquibase still works in:
	â€¢	Local
	â€¢	Dev server
	â€¢	GitLab pipeline

â¸»

âœ… 3. New Correct Project Structure (Target)

You should change from this:

src/main/resources/liquibase/

âœ… To this:

liquibase/
  â”œâ”€â”€ db.changelog-master.yml
  â”œâ”€â”€ changes/
  â”œâ”€â”€ data/
  â”‚   â””â”€â”€ data.csv

âœ… Your project root should look like this:

bank-info/
â”œâ”€â”€ liquibase/
â”‚   â”œâ”€â”€ db.changelog-master.yml
â”‚   â”œâ”€â”€ changes/
â”‚   â””â”€â”€ data/
â”œâ”€â”€ src/
â”œâ”€â”€ pom.xml
â”œâ”€â”€ target/

ğŸš¨ This guarantees that CSV files are NOT inside the JAR anymore.

â¸»

âœ… 4. Update Your GitLab Liquibase Job (VERY IMPORTANT)

Change this line in your pipeline:

âŒ Current:

LIQUIBASE_SEARCH_PATH: "./src/main/resources/liquibase"

âœ… Replace with:

LIQUIBASE_SEARCH_PATH: "./liquibase"

So your job becomes:

updateLiquibase:
  stage: liquibase
  before_script: []
  environment: $GITLAB_ENV
  variables:
    JAVA_HOME: "/usr/lib/jvm/jdk-21.0.8-oracle-x64/"
    LIQUIBASE_COMMAND_CHANGELOG_FILE: "db.changelog-master.yml"
    LIQUIBASE_SEARCH_PATH: "./liquibase"
  script:
    - liquibase update
  when: manual
  tags:
    - "$GITLAB_TAG"

âœ… Now GitLab will correctly read your external Liquibase folder.

â¸»

âœ… 5. How To Manage This on the DEV Server

You showed this on the server:

bank-info.env  
bank-info.jar  
java.env  
logs  
startup.sh

You must now ADD liquibase next to the JAR:

âœ… Final structure on the server:

/opt/bank-info/
â”œâ”€â”€ bank-info.jar
â”œâ”€â”€ liquibase/
â”‚   â”œâ”€â”€ db.changelog-master.yml
â”‚   â”œâ”€â”€ changes/
â”‚   â””â”€â”€ data/
â”‚       â””â”€â”€ data.csv
â”œâ”€â”€ bank-info.env
â”œâ”€â”€ java.env
â”œâ”€â”€ logs
â”œâ”€â”€ startup.sh


â¸»

âœ… 6. How To Run Liquibase on the DEV Server

From the project root on the server:

liquibase \
  --search-path=./liquibase \
  --changeLogFile=db.changelog-master.yml \
  update

âœ… This applies DB changes using external CSV files
âœ… No CSVs inside the JAR
âœ… Matches your new GitLab behavior

â¸»

âœ… 7. IMPORTANT: Spring Boot Must NOT Reference Liquibase Anymore

If you currently have in application.yml or application.properties:

spring:
  liquibase:
    enabled: true

âš ï¸ This may try to run Liquibase from inside the JAR
Since Liquibase is now external, you should:

âœ… Either disable Spring Liquibase:

spring:
  liquibase:
    enabled: false

âœ… And rely ONLY on:
	â€¢	GitLab job
	â€¢	Manual server Liquibase runs

â¸»

âœ… 8. Summary (What You Must Do)

Task	Status
Move liquibase/ out of src/	âœ… Required
Update LIQUIBASE_SEARCH_PATH in GitLab	âœ… Required
Copy liquibase/ next to JAR on dev server	âœ… Required
Run Liquibase from external folder	âœ… Required
Disable Spring Boot Liquibase (if enabled)	âš ï¸ Recommended


â¸»

âœ… If You Want, I Can Also:
	â€¢	âœ… Review your db.changelog-master.yml
	â€¢	âœ… Check if your CSV loadData paths will still work
	â€¢	âœ… Adapt your startup.sh if Liquibase must auto-run at startup

Perfect â€” please paste the following files here (you can anonymize sensitive values):
	1.	âœ… liquibase/db.changelog-master.yml
	2.	âœ… One example of a changelog file that uses a CSV (the file inside changes/)
	3.	âœ… (Optional but recommended) your:
	â€¢	application.yml or application.properties
	â€¢	startup.sh from the server

â¸»

What I will do for you once you paste them:

âœ… Fix all file paths for the new external ./liquibase structure
âœ… Ensure all loadData CSV paths work correctly
âœ… Prevent Liquibase from trying to run inside the JAR
âœ… Make sure:
	â€¢	GitLab âœ…
	â€¢	Local âœ…
	â€¢	Dev server âœ…
All behave exactly the same

â¸»
Perfect question â€” this is exactly the right moment to clarify this âœ…
Here is the clean, correct, production-style way to run Liquibase locally when it is OUTSIDE the JAR.

Iâ€™ll assume your new structure is:

your-project/
â”œâ”€â”€ liquibase/
â”‚   â”œâ”€â”€ db.changelog-master.yml
â”‚   â”œâ”€â”€ changes/
â”‚   â””â”€â”€ data/
â”‚       â””â”€â”€ example.csv
â”œâ”€â”€ src/
â”œâ”€â”€ pom.xml


â¸»

âœ… OPTION 1 â€” Run Liquibase Locally with the CLI (BEST & SIMPLEST)

This is what your GitLab job already does, so it gives you 100% identical behavior.

â¸»

âœ… 1. Install Liquibase Locally

ğŸ”¹ On Linux:

sudo dnf install liquibase
# or
sudo apt install liquibase

ğŸ”¹ On Mac:

brew install liquibase

ğŸ”¹ Verify:

liquibase --version


â¸»

âœ… 2. Create a liquibase.properties File (RECOMMENDED)

Create this file:

your-project/liquibase/liquibase.properties

âœ… Example:

url=jdbc:postgresql://localhost:5432/bankinfo
username=bankuser
password=bankpass
driver=org.postgresql.Driver

searchPath=./liquibase
changeLogFile=db.changelog-master.yml

âœ… Now you donâ€™t need to type everything every time.

â¸»

âœ… 3. Run Liquibase Locally

From your project root:

liquibase update

âœ… Thatâ€™s it.
âœ… It uses:
	â€¢	./liquibase/db.changelog-master.yml
	â€¢	./liquibase/data/*.csv
	â€¢	Your local database

â¸»

âœ… 4. If You Donâ€™t Want a .properties File (Manual Mode)

You can also run it like this:

liquibase \
  --url=jdbc:postgresql://localhost:5432/bankinfo \
  --username=bankuser \
  --password=bankpass \
  --search-path=./liquibase \
  --changeLogFile=db.changelog-master.yml \
  update

This is exactly what GitLab does behind the scenes.

â¸»

âœ… OPTION 2 â€” Run Liquibase with Maven (ALSO WORKS)

Only use this if your project already has the Liquibase Maven plugin.

Run:

mvn liquibase:update \
  -Dliquibase.searchPath=./liquibase \
  -Dliquibase.changeLogFile=db.changelog-master.yml

âš ï¸ Warning:
If your CSV files are outside src, then:
	â€¢	loadData MUST use relative paths
	â€¢	No classpath: usage anymore

â¸»

âœ… VERY IMPORTANT â€” How Your CSV Must Be Written Now

Inside your changelog:

âŒ OLD (inside JAR):

loadData:
  file: classpath:liquibase/data/users.csv

âœ… NEW (external):

loadData:
  file: data/users.csv
  relativeToChangelogFile: true

âœ… This guarantees:
	â€¢	Works locally âœ…
	â€¢	Works on dev server âœ…
	â€¢	Works in GitLab âœ…
	â€¢	CSV never goes inside JAR âœ…

â¸»

âœ… OPTION 3 â€” Run Liquibase Using Docker (ZERO INSTALL)

If you donâ€™t want to install Liquibase:

docker run --rm \
  -v $(pwd)/liquibase:/liquibase \
  liquibase/liquibase \
  --search-path=/liquibase \
  --changeLogFile=db.changelog-master.yml \
  update


â¸»

âœ… How This Matches Your GitLab Pipeline

Your GitLab job:

LIQUIBASE_SEARCH_PATH: "./liquibase"
LIQUIBASE_COMMAND_CHANGELOG_FILE: "db.changelog-master.yml"
script:
  - liquibase update

âœ… Your local execution is now IDENTICAL to GitLab
âœ… No more surprises at deployment
âœ… No CSV inside the JAR

â¸»

âœ… FINAL CHECKLIST FOR LOCAL SETUP

Item	Required
Liquibase installed OR Docker used	âœ…
liquibase/ outside src/	âœ…
relativeToChangelogFile: true in CSV	âœ…
liquibase update runs without error	âœ…
No classpath: in CSV paths	âœ…


â¸»

âœ… If You Want, Next I Can:

âœ… Fix your actual CSV loadData config
âœ… Validate your db.changelog-master.yml
âœ… Ensure your dev server startup wonâ€™t accidentally re-run Liquibase
âœ… Align everything with your GitLab job perfectly

ğŸ‘‰ Paste your db.changelog-master.yml and one CSV changelog and Iâ€™ll correct them for you line by line.first.