variables:
  MAVEN_CLI_OPTS: "-B -s settings.xml"
  MAVEN_OPTS: "-Dmaven.repo.local=${CI_PROJECT_DIR}/.m2"
  GIT_DEVELOP_REGEX: "/(feat(ure)?\/.*)|develop/"
  GIT_UAT: "uat"
  GIT_MAIN: "main"
  GITLAB_TAG: "none"
  GITLAB_ENV: "none"



workflow:
  rules:
    - if : $CI_COMMIT_BRANCH =~ $GIT_SNAPSHOT_REGEX
      variables:
        GITLAB_TAG: "deploy_dev"
        GITLAB_ENV: "develop"
    - if : $CI_COMMIT_BRANCH == $GIT_UAT
      variables:
        GITLAB_TAG: "deploy_uat"
        GITLAB_ENV: "uat"
    - if : $CI_COMMIT_BRANCH == $GIT_MAIN
      variables:
        GITLAB_TAG: "deploy_prd"
        GITLAB_ENV: "prd"


default:
  image: maven:3.9.10-amazoncorretto-21-alpine

stages:
  - liquibase
  - build
  - publish

cache:
  key: ${CI_COMMIT_REF_SLUG}
  paths:
    - ${CI_PROJECT_DIR}/.m2

before_script:
  - echo "Importing Olky CA trust to jdk cacert store"
  - echo "$OLKY_CA_BUNDLE_BASE64" | base64 -d > olky.pem
  - keytool -importcert -alias olky-root -file ./olky.pem -storepass $JAVA_KEYSTORE_PASSWORD -noprompt -keystore $JAVA_HOME/lib/security/cacerts
  
updateLiquibase:
  stage: liquibase
  before_script: []
  environment: $GITLAB_ENV
  variables:
    JAVA_HOME: "/usr/lib/jvm/jdk-21.0.8-oracle-x64/"
    LIQUIBASE_COMMAND_CHANGELOG_FILE: "db.changelog-master.yml"
    LIQUIBASE_SEARCH_PATH: "./src/main/resources/liquibase"
  script:
    - liquibase update
  when: manual
  tags:
    - "$GITLAB_TAG"


build-job:
  stage: build
  script:
    - echo " Build..."
    - mvn $MAVEN_CLI_OPTS clean package
  artifacts:
    paths:
      - target/business-registry.jar

publish:
  stage: publish
  script:
    - mvn $MAVEN_CLI_OPTS deploy

deploy:
  needs:
    - job: build-job
  stage: publish
  before_script: [] # No need to import certs for this job
  environment: $GITLAB_ENV
  script:
    - 'sudo /opt/script/gitlab/deploy_java_jar.sh -j ./target/business-registry.jar -d /opt/business-registry/ -u business-registry -s business-registry'
  tags:
    - "$GITLAB_TAG"
this is the pipeline i jsut want to understant the liquibase part and to be able to do this :

[root@OLK-DEV-Back-01 bank-info]# ls
bank-info.env  bank-info.jar  java.env  logs  startup.sh

this is how it look like my file on dev server and they want me to do this : 
- le dossier liquidbase doit etre sorti de src afin de pas retrouver les fichier .csv dans le jar spring boot.

how should i do to manage this locally and dev server
