   @RequestMapping(value = "/{orderId}/", method = RequestMethod.GET)
    public ResponseEntity<byte[]> generate(@PathVariable("orderId") int orderId) throws Exception {
        LOGGER.info("Sct request for SCT order with ID <{}>", orderId);
        byte[] content = _sctDebitPdfWriter.generateDocument(orderId);
        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_PDF);
        String filename = new StringBuilder("Avis-débit-").append(orderId).append(".pdf").toString();
        headers.setContentDispositionFormData(filename, filename);
        headers.setCacheControl("must-revalidate, post-check=0, pre-check=0");
        ResponseEntity<byte[]> response = new ResponseEntity<byte[]>(content, headers, HttpStatus.OK);
        return response;
    }

    @PostMapping(value = "/generate", produces = MediaType.APPLICATION_PDF_VALUE)
    public ResponseEntity<?> generate(@RequestBody SctDebitData data) throws Exception {
        String validationError = validateSctDebitData(data);
        Map<String, String> errorBody = new HashMap<>();
        errorBody.put("error", validationError);
        if (validationError != null) {
            LOGGER.warn("Invalid input for order: {} -> {}", data.getOrderId(), validationError);
            return ResponseEntity
                    .status(HttpStatus.BAD_REQUEST)
                    .contentType(MediaType.APPLICATION_JSON)
                    .body(errorBody);
        }
        byte[] pdf = _sctDebitPdfWriter.generatePdf(data);
        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_PDF);
        String filename = String.format("Avis-debit-%d.pdf", data.getOrderId());
        headers.setContentDispositionFormData(filename, filename);
        headers.setCacheControl("must-revalidate, post-check=0, pre-check=0");
        LOGGER.info("PDF generated successfully for order <{}>", data.getOrderId());
        return new ResponseEntity<>(pdf, headers, HttpStatus.OK);
    }

J'ai 2 API's, le deuxieme permet de te generer un avis de débit a travers des l'obejt en body. le 1er recupere à partir de la base
    

sur cette methode j'aimerai avant de generer le pdf, faire une verification en base de données si SctDebitData correct pour valider si les données :

    public byte[] generatePdf(SctDebitData data) throws Exception {
        LOGGER.info("Generating SCT document for order <{}>", data.getOrderId());

        DocumentTemplate documentTemplate = _docTemplateSvc.findLastVersionActive(SCT_TEMPLATE);
        Document document = new Document(new ByteArrayInputStream(documentTemplate.getContent()));

        document.getBuiltInDocumentProperties().setTitle("Avis de débit");
        document.getBuiltInDocumentProperties().setAuthor("Olkypay");
        document.getBuiltInDocumentProperties().setCompany("Olkypay");
        document.getBuiltInDocumentProperties().setKeywords(
                String.format("%s %s", data.getOrderId(),
                        Optional.ofNullable(data.getTxId()).orElse(""))
        );
        SctDebitPdfContent content = mapToContent(data);
        CustomDocumentProperties cdp = document.getCustomDocumentProperties();
        setDocumentProperties(cdp, content);
        document.updateFields();
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        document.save(baos, SaveFormat.PDF);
        return baos.toByteArray();
    }

    private SctDebitPdfContent mapToContent(SctDebitData data) {
        SctDebitPdfContent content = new SctDebitPdfContent();
        content.setSupplierName(data.getSupplierName());
        content.setSupplierIban(data.getSupplierIban());
        content.setOutName(data.getOutName());
        content.setOutIban(data.getOutIban());
        content.setOutAddress(data.getOutAddress());
        if (data.getAmount() != null) {
            content.setAmount(data.getAmount().stripTrailingZeros().toPlainString());
        } else {
            content.setAmount("0.00");
        }
        content.setExecutionDate(data.getExecutionDate());
        content.setLabel(data.getLabel());
        content.setEndToEndId(data.getEndToEndId());
        content.setTxId(data.getTxId());
        content.setControlKey(data.getTxId());
        return content;
    }

base toi sur ça vu ça contient les élement qu'on récupère de la table order_payment pour les mapper après sur le mm pdf qui est générer par orderId: je veux faire la corrrespondence de ces données avec les données sur SctDebitData







